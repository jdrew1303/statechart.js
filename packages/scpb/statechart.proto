syntax = "proto3";

package statechart;

message Document {
  string name = 1;
  repeated State states = 2;
  repeated Transition transitions = 3;
  string datamodel = 4;
  map<string, string> meta = 5;
}

message State {
  enum Type {
    compound = 0;
    atomic = 1;
    parallel = 2;
    history_shallow = 3;
    history_deep = 4;
    initial = 5;
    final = 6;
  }
  Type type = 1;
  uint32 idx = 2;
  string id = 3;
  repeated bytes on_init = 4;
  repeated bytes on_enter = 5;
  repeated bytes on_exit = 6;
  repeated Invocation invocations = 7;
  uint32 parent = 8;
  bytes children = 9;
  bytes ancestors = 10;
  bytes completion = 11;
  bytes transitions = 12;
  bool has_history = 13;
  string name = 14;
}

message Transition {
  enum Type {
    external = 0;
    targetless = 1;
    internal = 3;
    spontaneous = 4;
    history = 5;
    initial = 6;
  }
  Type type = 1;
  uint32 idx = 2;
  uint32 source = 3;
  bytes event = 4;
  bytes condition = 5;
  repeated bytes on_transition = 6;
  bytes targets = 7;
  bytes conflicts = 8;
  bytes exits = 9;
  string name = 10;
}

message Invocation {
  bytes type = 1;
  bytes src = 2;
  bytes id = 3;
  bytes content = 4;
  repeated bytes on_exit = 5;
  bool autoforward = 6;
}
